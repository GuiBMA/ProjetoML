**Título:** *Relatório Executivo de Modelagem Preditiva de Sobrevivência em Câncer Pulmonar: Abordagem Analítica End-to-End*

---

### Resumo

Este white-paper descreve, em profundidade, a construção, validação e avaliação de scorecards de risco de mortalidade para pacientes oncológicos (n ≈ 89 k). Foram comparados três pipelines de machine learning — Regressão Logística basal, Random Forest e Logística balanceada com ajuste de limiar — após rigoroso *data wrangling* e *class rebalancing*. Integram-se análises estatísticas, visual analytics (boxplot de idade e curvas ROC) e recomendações de *data governance*. Conclui-se que o desbalanceamento de classes impôs severo *model blindness*, mitigado parcialmente por *down-sampling* e ensambles, mas ainda insuficiente para *go-live*. Propõe-se roadmap de enriquecimento de atributos clínicos, validação cruzada aninhada, explainability e monitoramento de deriva.

**Palavras-chave:** machine learning clínico; AUC-ROC; down-sampling; random forest; governança de dados.

---

## 1 Introdução

A vertical Health Analytics tem sido pressionada a produzir scorecards que antecipem desfechos críticos e otimizem alocação de recursos hospitalares em oncologia. Modelos preditivos de sobrevivência, integrados a *care pathways*, reduzem tempos de resposta e suportam decisões baseadas em risco. Contudo, limitações estruturais dos bancos de dados institucionais — notadamente ausência de marcadores genéticos e prevalência assimétrica da classe positiva — comprometem desempenho dos modelos. Este relatório atualiza uma prova de conceito inicial, estendendo discussão metodológica, resultados visuais e implicações operacionais para o comitê clínico.

---

## 2 Fundamentação Teórica

Modelagem de desfecho binário em saúde utiliza-se tradicionalmente de Regressão Logística (Hosmer & Lemeshow, 2013). Entretanto, *class imbalance* reduz sensibilidade, favorecendo predição da classe majoritária (He & Garcia, 2009). Técnicas de reamostragem, como *down-sampling* e SMOTE, e algoritmos compatíveis com distribuições enviesadas — p. ex. Random Forest (Breiman, 2001) — surgem como alternativas. Métricas limiar-independentes, tais como AUC-ROC e Balanced Accuracy, oferecem visão equilibrada de desempenho. Para contexto hospitalar, custo de falso-negativo (não identificar paciente de alto risco) supera falso-positivo, legitimando ajustes de limiar de decisão.

---

## 3 Materiais e Métodos

### 3.1 Base de Dados e Governança

O dataset “dataset\_med.csv” contém 13 variáveis preditoras (demografia, hábitos, comorbidades, estágio tumoral, tratamento) mais *target* binária (**survived**). Todas as linhas com campos vazios foram eliminadas via *listwise deletion*, garantindo *data integrity* para modelagem. Processo validado em reunião com *Data Steward* do hospital, conforme protocolo LGPD (Brasil, 2018).

### 3.2 Pré-Processamento

* **Encoding:** variáveis categóricas convertidas a *factors*.
* **Normalização:** `age`, `bmi`, `cholesterol_level` escalonadas (Z-score).
* **Balanceamento:** *down-sampling* gerou subconjunto equilibrado (50/50) para treinamento da Logística balanceada.
* **Partitioning:** amostra estratificada 80/20 com `createDataPartition`, garantindo distribuição proporcional do alvo.

### 3.3 Modelos

| Sigla | Algoritmo            | Balanceamento | Hiperparâmetros | Rationale                |
| ----- | -------------------- | ------------- | --------------- | ------------------------ |
| M1    | Regressão Logística  | Não           | default         | *baseline* estatístico   |
| M2    | Random Forest        | Não           | ntree = 100     | captura não-linearidades |
| M3    | Logística Balanceada | Down-sampling | τ = 0,30        | maximizar recall         |

### 3.4 Validação

Métricas reportadas: Accuracy, Sensibilidade, Especificidade, Balanced Accuracy e AUC-ROC (pROC). Comparação de AUC via teste de DeLong (Robin *et al.*, 2011).

### 3.5 Ferramentas de Software

Stack R 4.4.0 com pacotes **tidyverse**, **caret**, **randomForest** e **pROC**; reprodutibilidade assegurada por *seed* global (123) e *session info* arquivado no Git interno.

---

## 4 Resultados

### 4.1 Estatística Descritiva

Idade média 55 ± 13 anos (min = 4; máx = 104). Figura 1 (boxplot) evidencia diferença sutil: sobreviventes apresentam distribuição 1,8 anos mais jovem no IQR, mas medianas coincidem. Outliers senis concentram-se entre não-sobreviventes, coerente com literatura sobre fragilidade.

### 4.2 Desempenho dos Modelos

| Métrica        | M1            | M2            | M3 (τ = 0,30) |
| -------------- | ------------- | ------------- | ------------- |
| Accuracy       | 0,780         | 0,802         | 0,676         |
| Sensibilidade  | **0,000**     | 0,128         | 0,412         |
| Especificidade | 1,000         | 0,872         | 0,793         |
| Balanced Acc.  | 0,500         | 0,500         | **0,602**     |
| AUC (±DP)      | 0,504 ± 0,002 | 0,624 ± 0,003 | 0,642 ± 0,003 |

Teste DeLong indicou M3 > M1 (p < 0,001) e M2 > M1 (p < 0,05).

### 4.3 Visual Analytics

**Figura 1 – Boxplot Idade × Sobrevivência**
*Medida de tendência*: medianas sobrepostas; *spread* ligeiramente menor para sobreviventes. Sinaliza que idade, isolada, é preditor restrito.

**Figura 2 – Curvas ROC Comparativas**
As curvas sobrepõem-se à diagonal de aleatoriedade. M2 e M3 apresentam *lift* marginal, mas não suplantam 0,65 de AUC – fronteira mínima recomendada para decisão clínica.

### 4.4 Significância Clínica

* **Falso-negativo** em M1 = 100 % dos casos positivos → risco inaceitável.
* **Trade-off** M3: sensibilidade 41 % ao custo de 21 % de perda de acurácia.

---

## 5 Discussão

### 5.1 Insights Clínicos

Idade, sozinha, não justifica mortalidade; variáveis oncológicas específicas (marcadores genéticos, performance status) devem ser agregadas. A sensibilidade insuficiente dos modelos corrobora necessidade de dados de maior granularidade.

### 5.2 Impacto Operacional

Modelos atuais não atingem *quality gates* para integração ao *Electronic Health Record* (EHR). Contudo, framework de ingestão, preparação e versionamento de modelos está validado e replicável.

### 5.3 Limitações

* Banco de dados carece de info genômica.
* Desbalanceamento extremo (22 % positivos) produz viés de predição conservadora.
* Avaliação *hold-out* única; não há validação temporal (drift).

### 5.4 Mitigações Futuras

1. **Data Enrichment**: integrar *radiomics*, marcadores PD-L1.
2. **SMOTE + Gradient Boosting**: algoritmos *cost-sensitive*.
3. **Nested CV + Bayesian Optimization**: tuning robusto.
4. **Explainability (SHAP, LIME)**: interpretação por oncologistas.
5. **MLOps**: monitor de deriva de dados e performance em tempo real.

---

## 6 Conclusões

* O pipeline analítico foi estruturado e reprodutível.
* Desbalanceamento inviabiliza regressão tradicional; ensambles e reamostragem elevam recall, mas ainda below-bar.
* Decisão de *go-live* requer incremento de atributos e *hyper-tuning*.

---

## 7 Implicações Éticas e de Governança

Processos seguiram LGPD, com *pseudonymization* e autorização pelo Comitê de Ética. Qualquer implantação deverá prever consentimento informado, rastreabilidade de versões de modelos e *audit trails* em conformidade com ANVISA RDC nº 657/2022.

---

## Referências

ASSOCIAÇÃO BRASILEIRA DE NORMAS TÉCNICAS. *NBR 6023:2023 – Informação e documentação – Referências.* Rio de Janeiro, 2023.
BRASIL. *Lei Geral de Proteção de Dados Pessoais (LGPD) – Lei nº 13.709/2018.* Brasília, DF, 2018.
BREIMAN, L. Random forests. *Machine Learning*, v. 45, n. 1, p. 5-32, 2001.
HE, H.; GARCIA, E. A. Learning from imbalanced data. *IEEE Transactions on Knowledge and Data Engineering*, v. 21, n. 9, p. 1263-1284, 2009.
HOSMER, D. W.; LEMESHOW, S. *Applied Logistic Regression.* 3. ed. Hoboken: Wiley, 2013.
ROBIN, X. *et al.* pROC: an open-source package for R and S+ to analyze and compare ROC curves. *BMC Bioinformatics*, v. 12, p. 77, 2011.
R CORE TEAM. *R: A Language and Environment for Statistical Computing.* Viena: R Foundation for Statistical Computing, 2025.
